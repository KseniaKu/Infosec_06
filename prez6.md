---
title: "Лабораторная работа №6"
author: |
  Кувшинова Ксения Олеговна\inst{1}
date: "14.10.2022, Moscow"
output:
  beamer_presentation: default
  slidy_presentation: default
  ioslides_presentation: default
  powerpoint_presentation: default
subtitle: "Мандатное разграничение прав в Linux"
lang: ru-RU
institute: |
  \inst{1}RUDN University, Moscow, Russian Federation
toc: no
slide_level: 2
theme: metropolis
header-includes:
- \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
- \makeatletter
- \beamer@ignorenonframefalse
- \makeatother
aspectratio: 43
section-titles: yes
---


## Цель работы

Целью данной лабораторной работы является развить навыки администрирования ОС Linux. Получить первое практическое знакомство с технологией SELinux1. Проверить работу SELinx на практике совместно с веб-сервером
Apache.

## Подготовка лабораторного стенда

Установили веб-сервер Apache. (@fig:001)
   
![Установка веб-сервера Apache](1.JPG){#fig:001 width=100%}

## Подготовка лабораторного стенда

В конфигурационном файле /etc/httpd/httpd.conf задали параметр ServerName. (@fig:002)
   
![Установка параметра ServerName](4.JPG){#fig:002 width=100%}

Отключаем пакетный фильтр. (@fig:003)

![Отключение пакетного фильтра](5.JPG){#fig:003 width=100%}

## Выполнение лабораторной работы

Входим в систему с полученными учётными данными. Проверили, что SELinux работает в режиме enforcing политики targeted. (@fig:004)
   
![Выполнение команд getenforce и sestatus](2.1.JPG){#fig:004 width=100%}

## Выполнение лабораторной работы

Запустили веб-сервер и обратились к нему (@fig:005)

![Выполнение команд service httpd start и status](2.2.JPG){#fig:005 width=100%}

## Выполнение лабораторной работы

Найшли веб-сервер Apache в списке процессов. Контекст безопасности - unconfined_u:unconfined_r:unconfined_t. (@fig:006)
   
![Выполнение команды ps auxZ | grep httpd](2.3.JPG){#fig:006 width=100%}

## Выполнение лабораторной работы

Посмотрели текущее состояние переключателей SELinux для Apache. (@fig:007)
   
![Выполнение команды sestatus -b | grep httpd](2.4.JPG){#fig:007 width=70%}

## Выполнение лабораторной работы

Посмотрели статистику по политике. Определили, что множество пользователей = 8; ролей = 14; типов = 5002. (@fig:008)
   
![Статистика по политике](2.5.JPG){#fig:008 width=100%}

## Выполнение лабораторной работы

Определили тип файлов и поддиректорий, находящихся в директории /var/www. (@fig:009)
   
![Выполнение команды ls -lZ /var/www](2.6.JPG){#fig:009 width=100%}

## Выполнение лабораторной работы

Необходимо было определить тип файлов, находящихся в директории /var/www/html. Но в данной директории файлов не обнаружилось. (@fig:010)
   
![Выполнение команды ls -lZ /var/www/html](2.7.JPG){#fig:010 width=100%}

## Выполнение лабораторной работы

Определим круг пользователей, которым разрешено создание файлов в директории /var/www/html. (@fig:011)
   
![Выполнение команды ls -lZ /var/www](2.6.JPG){#fig:011 width=100%}

## Выполнение лабораторной работы

Создали от имени суперпользователя html-файл /var/www/html/test.html следующего содержания: (@fig:012)
   
![Содержимое файла test.html](2.9.JPG){#fig:012 width=100%}

## Выполнение лабораторной работы

Проверили контекст созданного файла - httpd_sys_content_t. (@fig:013)
   
![Контекст файла test.html](2.10.JPG){#fig:013 width=100%}

## Выполнение лабораторной работы

Обратитились к файлу через веб-сервер, введя в браузере адрес http://127.0.0.1/test.html и убедились, что файл был успешно отображён. (@fig:014)
   
![Обращение к файлу test.html через веб-сервер](2.11.JPG){#fig:014 width=100%}

## Выполнение лабораторной работы

Изменили контекст файла /var/www/html/test.html с httpd_sys_content_t на samba_share_t(@fig:015)
   
![Изменение контекста файла /var/www/html/test.html](2.13.JPG){#fig:015 width=100%}

## Выполнение лабораторной работы

Пробуем ещё раз получить доступ к файлу через веб-сервер. (@fig:016)
   
![Обращение к файлу test.html через веб-сервер после изменения контекста](2.14.JPG){#fig:016 width=100%}

## Выполнение лабораторной работы

Проанализируем ситуацию. Просмотрим log-файлы веб-сервера Apache и системный лог-файл. В системе оказались запущенны процессы **setroubleshootd** и **audtd**. (@fig:017)
   
![Вывод команд ls -l /var/www/html/test.html и tail /var/log/messages](2.15.JPG){#fig:017 width=70%}

## Выполнение лабораторной работы

Попробуем запустить веб-сервер Apache на прослушивание ТСР-порта 81. Для этого в файле /etc/httpd/httpd.conf заменяем строчку на Listen 81. (@fig:018)
   
![Запуск веб-сервера Apache на прослушивание ТСР-порта 81](2.16.JPG){#fig:018 width=100%}

## Выполнение лабораторной работы

Выполним перезапуск веб-сервера Apache. Проанализируем лог-файлы.(@fig:019)
   
![Перезапуск веб-сервера Apache](2.17.JPG){#fig:019 width=100%}

## Выполнение лабораторной работы

Определим 81 порт tcp. После этого проверим список портов. (@fig:020)
   
![Проверка установления 81 порта tcp](2.19.JPG){#fig:020 width=100%}

## Выполнение лабораторной работы

Попробуем запустить веб-сервер Apache ещё раз. (@fig:021)
   
![Перезапуск веб-сервера Apache](2.20.JPG){#fig:021 width=100%}

## Выполнение лабораторной работы

Вернули контекст httpd_sys_cоntent__t к файлу /var/www/html/test.html.(@fig:022)
   
![Возвращение контекста httpd_sys_cоntent__t к файлу test.html](2.21.1.JPG){#fig:022 width=100%}

## Выполнение лабораторной работы

После этого пробуем получить доступ к файлу через веб-сервер, введя в браузере адрес http://127.0.0.1:81/test.html. (@fig:023)
   
![Обращение к файлу test.html через веб-сервер](2.21.2.JPG){#fig:023 width=100%}

## Выполнение лабораторной работы

Исправим обратно конфигурационный файл apache, вернув Listen 80. (@fig:024)
   
![Исправление конфигурационного файла apache](2.22.JPG){#fig:024 width=100%}

## Выполнение лабораторной работы

Удалим привязку http_port_t к 81 порту. (@fig:025)
   
![Удаление привязки http_port_t к 81 порту](2.23.JPG){#fig:025 width=100%}

Удалим файл /var/www/html/test.html. (@fig:026)
   
![Удаление файла test.html](2.24.JPG){#fig:026 width=100%}

## Результат выполнения работы

В ходе выполнения лабораторной работы мы развили навыки администрирования ОС Linux. Получили первое практическое знакомство с технологией SELinux1. Проверили работу SELinx на практике совместно с веб-сервером
Apache.

## Библиография

1. Кулябов Д. С., Королькова А. В., Геворкян М. Н. Мандатное разграничение прав в Linux [Текст] / Кулябов Д. С., Королькова А. В., Геворкян М. Н. - Москва: - 5 с. [^1]: Мандатное разграничение прав в Linux. 
2. Справочник 70 основных команд Linux: полное описание с примерами (https://eternalhost.net/blog/sozdanie-saytov/osnovnye-komandy-linux)
  